\begin{frame}{Broadie-Kaya Simulatation Method}{Definition}
    It folows from Heston model, that for $t > u$
    \begin{align}
         S_t &= S_u e^{\left( r(t-u)-\frac{1}{2} \int_{u}^{t} v_s \, ds  + \rho\int_{u}^{t} \sqrt{v_s} \, dZ_1(s) + (1-\rho)\int_{u}^{t} \sqrt{v_s} \, dZ_2(s)  \right)}, \label{BK:Price_int} \\
         v_t &= v_u + \kappa\theta(t-u) - \kappa \int_{u}^{t} v_s \, ds + \sigma\int_{u}^{t} \sqrt{v_s} \, dZ_2(s), \label{BK:Vol_int}
    \end{align}
    Exact Simulation Algorithm for the SV Model
    \begin{enumerate}
        \item[Step 1] Generate a sample from the distribution of $v_t$ given $v_u$.
        \item[Step 2] Generate a sample from the distribution of $\int_{u}^t V_s ds$ given $v_t$ and $v_u$.
        \item[Step 3] Recover $\int_{u}^t \sqrt{v_s} dZ_1(s)$ given $v_t$, $v_u$, and
        $\int_{t}^u v_s ds$
        \item[Step 4] Generate a sample from the distribution of $S_t$ given $\int_{u}^t \sqrt{v_s} dZ_1(s)$ and $\int_{u}^t v_s ds$
    \end{enumerate}
\end{frame}

\begin{frame}{Broadie-Kaya Simulatation Method}{Step 1: Generate a sample from the distribution of $v_t$ given $v_u$}
    As shown in Cox et al. (1985) the distribution of $v_t$ given $v_u$ for some u < t is, up to a  scale factor, a noncentral chi-squared distribution. The transition law of $v_t$ can be expressed as:

    \begin{equation}
        v_t = \frac{\sigma^2(1-e^{-\kappa(t-u)})}{4\kappa}\chi_d'^{2}\left(\frac{4\kappa e^{-\kappa(t-u)}}{\sigma^2(1-e^{-\kappa()t-u})} v_u  \right), t > u , \label{BK:vol_law}
    \end{equation}

    where $\chi_d'^{2}(\lambda)$ denotes the noncentral chi-squared random
    variable with d degrees of freedom, and noncentrality
    parameter $\lambda$, and

    \begin{equation}
        d = \frac{4\theta\kappa}{\sigma^2} \label{BK:vol_law:parameter}
    \end{equation}
    
\end{frame}


\begin{frame}{Broadie-Kaya Simulatation Method}{Step 1: Generate a sample from the distribution of $v_t$ given $v_u$}
    Thus, we can sample from the distribution of $v_t$ exactly,
    provided that we can sample from the noncentral chisquared distribution.

    Johnson et al. (1994) show that for $d > 1$, the following representation is valid:


    \begin{equation}
        \chi_d'^{2}(\lambda) = \chi_1'^{2}(\lambda) + \chi_{d-1}'^{2} = N(\lambda, 1)^2 + \chi_{d-1}^{2}
    \end{equation}

    Therefore,  when $d > 1$ sampling from a noncentral chi-squared distribution
    is reduced to sampling from an ordinary chi-squared and
    an independent normal.

    When $d < 1$ we can use the the fact that:

    \begin{equation}
        \chi_d'^{2}(\lambda) \sim \chi_{d + 2N}^{2}
    \end{equation}

    Where $N$ is a Poisson random variable with mean $\frac{\lambda}{2}$

    
\end{frame}

\begin{frame}{Broadie-Kaya Simulatation Method}{Step 2:  Generate a sample from the distribution of $\int_{u}^t V_s ds$ given $v_t$ and $v_u$}
    The folowing formula can be derived 

    
    \begin{align}
        \phi(a) = \E\left[  \exp{ia\int_{u}^t V_s ds} \Bigg| v_u, v_t\right] = \frac{\gamma(a)e^{-(1/2)(\gamma(a) - \kappa)(t - u)}}{\kappa(1-e^{-\gamma(a)(t-u)})} \\
        \exp{\frac{v_u + v_t}{\sigma^2} \left[  \frac{\kappa(1+e^{-\kappa(t-u)})}{1-e^{-\kappa(1-u)}}                 \right]     }
    \end{align}

    Therefore,  when $d > 1$ sampling from a noncentral chi-squared distribution
    is reduced to sampling from an ordinary chi-squared and
    an independent normal.

    When $d < 1$ we can use the the fact that:

    \begin{equation}
        \chi_d'^{2}(\lambda) \sim \chi_{d + 2N}^{2}
    \end{equation}

    Where $N$ is a Poisson random variable with mean $\frac{\lambda}{2}$
\end{frame}


